<?xml version="1.0"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN" 
   "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd" [
<!ENTITY hlaintro SYSTEM "hlaintro.xml">
<!ENTITY methods SYSTEM "methods.xml">
<!ENTITY pypop SYSTEM "pypop.xml">
<!ENTITY glossary SYSTEM "glossary.xml">
<!ENTITY biblio SYSTEM "biblio.xml">
]>
<book xmlns:xi="http://www.w3.org/2001/XInclude">
 <bookinfo>
  <title>IHWG Analyses</title>
  <subtitle>Documentation for programs and methodology used for analyses
   of the IHWG population data.</subtitle>
  
  <corpauthor><ulink url="http://allele5.biol.berkeley.edu">
    Thomson Lab</ulink></corpauthor>
  <author>
   <affiliation>
    <orgname><ulink url="http://www.berkeley.edu/">University of California, Berkeley</ulink></orgname>
    <orgdiv><ulink url="http://ib.berkeley.edu/">Department of Integrative Biology</ulink></orgdiv>
    <orgdiv></orgdiv>
   </affiliation>
  </author>
  <releaseinfo>Version 0.2</releaseinfo>
  <pubdate>Last modified: $Date$ by $Author$</pubdate>
  
 </bookinfo>

 <xi:include href="hlaintro.xml"/>
 <xi:include href="methods.xml"/>
 <xi:include href="pypop.xml"/>
 <xi:include href="glossary.xml"/>
 <xi:include href="biblio.xml"/>

<!--
 &hlaintro;
 &methods;
 &pypop; 
 &glossary;
 &biblio;
-->

<!--

This section is superceded by new instructions that Diogo is developing in HTML and will be DocBook-ified and inserted.
 
 <sect1>
  <title>Introduction</title>
  
  <para>One of the goals of the IHWG is to analyze data generated by
   the Anthropology component in the light of population genetics
   theory. In this document we offer a detailed outline of the methods
   used, their theoretical justification, the means by which they are
   implemented. We also provide a list of future developments and the
   status of the project.</para>
 </sect1>
 
 <sect1>
  <title>Population background data</title>
  
  <para>Information contained in the in the input file will be
   reported as part of the output, in order to aid interpretation of
   analyses.</para>
  
  <para>The following items will be reported for each population which is
   analyzed. Note that this information concerns the population as a whole;
   individual loci for that population may have different values with
   respect to other fields (e.g. sample size).</para>
  
  <itemizedlist>
   <listitem><para>lab code</para>
   </listitem>
   <listitem><para>typing method</para>
   </listitem>
   <listitem><para>ethnicity</para>
   </listitem>
   <listitem><para>origin (?)</para>
   </listitem>
   <listitem><para>collection site</para>
   </listitem>
   <listitem><para>latitude</para>
   </listitem>
   <listitem><para>longitude</para>
   </listitem>
  </itemizedlist>
  
 </sect1>
 
 <sect1>
  <title>Locus information and population genetics summary
   statistics</title>
  
  <para>For each locus, for a given population sample, report:</para>
  
  <itemizedlist>
   <listitem>
    <para>The <glossterm linkend="sample-size">sample size</glossterm> (in number of alleles)</para>
   </listitem>
   
   <listitem>
    <para>The number of distinct alleles in the sample
     (<glossterm linkend="locus-k"><varname>k</varname></glossterm>)
    </para>
   </listitem>
   
   <listitem>
    <para>The number of counts for each allele in the
     sample</para>
   </listitem>
   <listitem>
    <para>The gene diversity of the sample</para>
   </listitem>
  </itemizedlist>
  
  <para>
   Future work: include information about ambiguity of allelic
   assignments.  For example, report how many allele calls are
   ambiguous and maximum and minimum numbers of alleles (which will
   depend on how the ambiguity is resolved). Report standard error of
   the estimate of gene diversity (use resampling scheme for
   this?).</para>
  </sect1>

  <sect1>
  <title>Analyses</title>
  <sect2>
   <title>Test for Hardy-Weinberg proportions</title>
   
   <variablelist>
    <varlistentry>
     <term>Method</term>
     <listitem>
      <para>Chi-square test of contingency table.</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Input data</term>
     <listitem>
      <para>single locus genotypes</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Methodological outline</term>
     <listitem>
      <para>Compute observed and expected numbers of individuals
       per genotypic category and test the null hypothesis of <glossterm
	linkend="locus-hwe">HWE</glossterm> assuming
       that deviations between observed and expected counts are chi-square
       distributed. Cells for which the expected counts are lower than 5 are
       pooled into a single class.</para>
     </listitem>
    </varlistentry>
		<varlistentry>
     <term>Output</term>
     <listitem>
      <para> The number of genotypes in the lumped category.
       The number of degrees of freedom for the overall test.  The results
       are displayed in a diagonal matrix, where each cell represents a
       genotype. Cells along the diagonal are homozygotes.</para>
      
      <para>The test results are reported at three levels; 
       
       <orderedlist numeration="loweralpha">
	<listitem>
	 <para>each cell's contribution to the overall
	  chi-square is reported; </para>
	</listitem>
	<listitem>
	 <para>the <varname>p-value</varname> for each
	  cell's deviation from <glossterm linkend="locus-hwe">HWE</glossterm> is computed (? is this a
	  1 d.f. test?); </para>
	</listitem>
	<listitem>
	 <para>the overall deviation of all the cells
	  from <glossterm linkend="locus-hwe">HWE</glossterm> is reported, in the form of an overall
	  chi-square value.</para>
	</listitem>
       </orderedlist>
      </para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Current status</term>
     <listitem>
      <para> debugging code and verifying specifications, in
       particular definition of the number of degrees of freedom for pooled
       data.</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Future work</term>
     <listitem>
      <para>Implementation of exact test for contingency table, using
       the MCMC algorithm. Implementation of individual genotype tests
       for deviation from <acronym>HWE</acronym> using the test
       statistic described in John Chen's dissertation. Estimation of
       standard error around <varname>p-value</varname>s?  This can be
       done if resampling schemes are used.</para>
     </listitem>
    </varlistentry>

   </variablelist>
  </sect2>
  
  <sect2>
   <title>Test of neutrality.</title>
   
   <variablelist>
    <varlistentry>
     <term>Method</term>
     <listitem>
      <para>Ewens-Watterson homozygosity test of neutrality</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Input data</term>
     <listitem>
      <para> single locus genotypes; only the allele count
       information is used for this test.</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Analysis</term>
     <listitem>
      <para> Estimate sample homozygosity. Use tables of neutral
       simulations to obtain expected <varname>F</varname> under
       neutrality, and fraction of simulation results with
       <varname>F_exp</varname> that exceeds <varname>F_obs</varname>,
       thus providing a <varname>p-value</varname> for the null
       hypothesis of neutrality.  In the cases where there is no
       simulated <varname>2n</varname> value that matches that of the
       sample use the next higher <varname>2n</varname>, which will be
       conservative with respect the rejection of neutrality (explain
       in more detail).</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Output</term>
     <listitem>
      <para><varname>F_obs</varname>, <varname>F_exp</varname>,
       <varname>p-value</varname></para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Current status</term>
     <listitem>
      <para>Complete, requires formatting.</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Future work</term>
     <listitem>
      <para> Implement exact version of the test, which examines the
       distribution of homozygosity over all possible configurations
       of alleles, following Monty Slatkin's program. Also consider
       implementing the version of a test of neutrality that uses the
       probability of the configuration under neutrality (using the
       Ewens sampling formula).</para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
  
  <sect2>
   <title>Estimation of haplotype frequencies from multilocus
    genotypic data.</title>
   
   <variablelist>
    
    <varlistentry>
     <term>Method</term> 
     
     <listitem><para><firstterm>Expectation-Maximization</firstterm>
       (<acronym>EM</acronym>) algorithm.</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Input data</term>
     <listitem><para> Multilocus genotype data.</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Methodological outline</term> 
     
     <listitem><para> Using the <acronym>EM</acronym> algorithm, find the
       maximum likelihood estimate of haplotype frequencies.</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Output</term> 
     
     <listitem><para>Estimated frequency of all haplotypes that are
       estimated to occur with a frequency above an arbitrarily set
       (low) threshold.</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Current status</term> 
     
     <listitem><para> Code written in C, requires testing and
       integration with the remainder of the programs.</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Future work</term> 
     
     <listitem><para> Provide guidelines for <acronym>EM</acronym>
       parameters (number of starting conditions used) that are
       required to obtain reliable estimates. Estimate and report
       standard errors of haplotype frequency estimates; this may be
       done using a resampling method.</para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2>
   <title>Estimation of linkage disequilibrium values and
    <varname>p-value</varname>s for a test of the null hypothesis that the
    data is in linkage equilibrium.</title>
   
   <variablelist>
    
    <varlistentry>
     <term>Method</term> 
     
     <listitem>
      <orderedlist numeration="loweralpha">
       <listitem>
	<para>Use inferred haplotypes to estimate
	<acronym>LD</acronym> values;</para>
       </listitem>
       <listitem>
	<para>use likelihood ratio to test the null hypothesis
	 that the data is in <acronym>HW</acronym> equilibrium.</para>
       </listitem>
      </orderedlist>
     </listitem>
    </varlistentry>
		
    <varlistentry>
     <term>Input data</term>
     
     <listitem>
      <itemizedlist>
       <listitem>
	<para> Multilocus genotype data, from which haplotypes
	 are inferred; these are then used to estimate haplotypes from which
	 <acronym>LD</acronym> measures are estimated.</para>
       </listitem>
       <listitem>
	<para> Multilocus genotypes are used to perform a
	 likelihood ratio test of the null hypothesis of linkage
	 equilibrium.</para>
       </listitem>
      </itemizedlist>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Methodological outline</term>
     
     <listitem><itemizedlist> 
       
       <listitem>
	<para>For each pair of loci report tables with cells
	 containing the values for (a) the observed and (b) the
	 expected (under <acronym>HWE</acronym>) number of
	 counts. Each cell refers to a specific two locus
	 haplotype.</para>
       </listitem>
       
       <listitem>
	<para>Chi-square values for each two locus haplotype.</para>
       </listitem>
       
       <listitem>
	<para><acronym>LD</acronym> value for all pairs of alleles.</para>
       </listitem>
       
       <listitem>
	<para><acronym>LD</acronym> value (normalized) for all
	 pairs of alleles.</para>
       </listitem>
       
       <listitem>
	<para>Disequilibrium summary measures
	 (<varname>Wn</varname>, <varname>Q</varname>, <varname>D'</varname>)
	 which provide an overall measure of the degree of deviation from
	 linkage equilibrium for the pair of loci.</para>
       </listitem>
      </itemizedlist>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Output</term>
     <listitem><para>Not yet defined</para>
     </listitem>
    </varlistentry>
    
    <varlistentry>
     <term>Future work</term>
     
     <listitem><para> Implementation of likelihood ratio test of
       linkage equilibrium.  Testing of programme, addition of outputs
       for <varname>p-value</varname>s for the null hypothesis of
       linkage equilibrium, for both the individual and overall
       measures of <acronym>LD</acronym>. Consider feasibility of
       developing exact test for testing of linkage equilibrium using
       <acronym>MCMC</acronym> approach (as heuristic for Fisher's
       exact test).</para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
 </sect1>

-->
 
</book>

<!--
Local variables:
sgml-local-catalogs: ("catalog")
sgml-indent-step: 1
sgml-indent-data: 1
End:
-->