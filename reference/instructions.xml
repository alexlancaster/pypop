<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN" 
   "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">
<article condition="main" xmlns:xi="http://www.w3.org/2001/XInclude">

 <title>Guidelines for interpreting analyses of population genetic data</title>

 <subtitle>Preliminary population genetic analyses for the Anthropology
  Component of the 13th IHWG.</subtitle>

 <articleinfo>
  <authorgroup>
   <author>
    <firstname>Diogo</firstname>
    <surname>Meyer</surname>
   </author>
   <author>
    <firstname>Alex</firstname>
    <surname>Lancaster</surname>
   </author>
  </authorgroup>
  <pubdate>Last updated: $Date$ by $Author$</pubdate>
 </articleinfo>


 <para>This document is intended to provide you with information about
  the format and the meaning of the results and data summaries you
  have been sent.</para>

 <sect1 id="instructions-pop-summary">
  <title>Population Summary</title>

  <para>A Population Summary is generated for each population/dataset
   analyzed. It provides basic demographic information and summarizes
   information about the sample size.</para>

  <para>Sample output:</para>
  <example>
   <title>Population summary sample output</title>
<programlisting><![CDATA[
Population Summary
==================

       Lab code: USAFEL
  Typing method: 12th Workshop SSOP
      Ethnicity: Telle
      Continent: NW Asia
Collection site: Targen Village
       Latitude: 41 deg 12 min N
      Longitude: 94 deg 7 min E
Population Name: UchiTelle

Population Totals
_________________

Sample Size (n): 47
Allele Count (2n): 94
Total Loci in file: 9
Total Loci with data: 8
]]></programlisting>
  </example>

 </sect1>

 <sect1 id="instructions-locus-info">
  <title>Locus specific information</title>

  <para>Information relevant to individual loci is reported. If the
   sample size differs among loci (as is the case if not all
   individual were typed at each locus) sample size and allele count
   will differ among loci.  Untyped individuals are those for which
   one or two alleles were not typed. The alleles are listed in
   descending frequency.</para>

  <example>
   <title>Basic locus information sample output</title>
<programlisting><![CDATA[
1. Locus: A
===========


1.1. Allele Counts [A]
______________________

Untyped individuals: 2
Sample Size (n): 45
Allele Count (2n): 90
Distinct alleles (k): 10

Counts ordered by frequency   | Counts ordered by name        
Name      Frequency (Count)   | Name      Frequency (Count)   
0201      0.21111   19        | 0101      0.13333   12        
0301      0.15556   14        | 0201      0.21111   19        
0101      0.13333   12        | 0210      0.10000   9         
2501      0.12222   11        | 0218      0.10000   9         
0210      0.10000   9         | 0301      0.15556   14        
0218      0.10000   9         | 2501      0.12222   11        
3204      0.08889   8         | 3204      0.08889   8         
6901      0.04444   4         | 6814      0.03333   3         
6814      0.03333   3         | 6901      0.04444   4         
7403      0.01111   1         | 7403      0.01111   1         
Total     1.00000   90        | Total     1.00000   90        
]]></programlisting>
  </example>

  <para>In the cases where there is no information for a locus a message is
    displayed indicating lack of data. </para>

  <para>Sample output:</para>

<programlisting>
4. Locus: DRA
=============

 No data for this locus!
</programlisting>

 </sect1>
 
 <sect1 id="instructions-homozygosity">
  <title>Homozygosity test of neutrality</title>

  <para>For each locus the expected homozygosity under Hardy-Weinberg
   proportions (the sum of the squares of allele frequencies) is
   computed and reported. The expected homozygosity under neutrality,
   for the same sample size and number of unique alleles is obtained
   by simulation and reported (Expected Homozygosity). The Normalized
   Deviate of the Homozygosity values is the difference between the
   observed and expected homozygosity, divided by the square root of
   the variance of the expected homozygosity (also obtained by
   simulations). Negative Normalized deviates imply Observed
   Homozygosity values lower than Expected Homozygosity, in the
   direction of balancing selection. Positive values are in the
   direction of directional selection. The p-value provided in the
   last row of the output is the probability that the observed
   homozygosity would be obtained from a neutral sample (of size 2n
   and k distinct alleles).  P-values smaller than 0.05 reject the
   null hypothesis of neutrality.</para>

  <example>
   <title>Sample output of homozygosity test</title>
<programlisting><![CDATA[
1.4. Ewens-Watterson homozygosity test of neutrality [A]
________________________________________________________

Observed F: 0.1326, Expected F: 0.2651, Normalized deviate (Fnd): -1.4506
p-value range: 0.0000 < p <= 0.0100 *
]]></programlisting>
  </example>

 </sect1>

 <sect1 id="instructions-hardyweinberg">
  <title>Test for deviation from Hardy-Weinberg proportions (HWP).</title>

  <para>For each locus the observed genotype counts are compared to
   those expected under Hardy Weinberg Proportions (HWP). A triangular
   matrix reports observed and expected genotype counts. If there are
   more than nine loci, the matrix is split into different
   sections. Each cell contains the observed and expected number for a
   given genotype in the format observed/expected.</para>

  <example>
   <title>Sample output of Hardy-Weinberg genotype table</title>

 <programlisting><![CDATA[
1.2. HardyWeinberg [A]
______________________

Table of genotypes, format of each cell is: observed/expected.

0101 0/0.8
0201 2/2.5 6/2.0
0210 1/1.2 0/1.9 1/0.5
0218 4/1.2 0/1.9 0/0.9 1/0.5
0301 0/1.9 0/3.0 4/1.4 0/1.4 3/1.1
2501 3/1.5 2/2.3 0/1.1 1/1.1 2/1.7 0/0.7
3204 1/1.1 1/1.7 1/0.8 0/0.8 1/1.2 3/1.0 0/0.4
6814 0/0.4 1/0.6 0/0.3 1/0.3 0/0.5 0/0.4 1/0.3 0/0.1
6901 1/0.5 0/0.8 1/0.4 1/0.4 1/0.6 0/0.5 0/0.4 0/0.1 0/0.1
7403 0/0.1 1/0.2 0/0.1 0/0.1 0/0.2 0/0.1 0/0.1 0/0.0 0/0.0 0/0.0
      0101  0201  0210  0218  0301  2501  3204  6814  6901  7403
                             [Cols: 1 to 10]
]]></programlisting>
  </example>

  <para> The values in this matrix are used to test hypotheses of
   deviation from HWP. The output table reports the observed and
   expected number of genotypes, the chi-square statistic, the number
   of degrees of freedom and associated p value for the following
   classes of genotypes.</para>

  <itemizedlist>
   <listitem>
    <formalpara><title>Common</title>
     <para>The result
      for goodness of fit to HWP using only the genotypes with at
      least five expected counts (the common genotypes).</para>
    </formalpara>
   </listitem>

   <listitem>
    <formalpara><title>Lumped genotypes</title> 
     <para>The result for goodness
     of fit to HWP for the pooled set of genotypes that individually
     have less than five expected counts.  </para>
    </formalpara>
   </listitem>

   <listitem>
    <formalpara>
     <title>Common + lumped</title> <para>The
      result for goodness of fit to HWP for both the common and the
      lumped genotypes.</para>
    </formalpara>
   </listitem>
   
   <listitem>
    <formalpara>
     <title>All homozygotes</title>
     <para>The result for goodness of fit to HWP
    for the pooled set of homozygous genotypes.</para>
    </formalpara>
   </listitem>
   
   <listitem>
    <formalpara>
     <title>All heterozygotes</title> 
     <para>The result for goodness of fit to HWP
      for the pooled set of heterozygous genotypes.</para>
    </formalpara>
   </listitem>
   
  </itemizedlist>

  <example>
  <title>Sample output of HW classes</title>
  
<programlisting><![CDATA[
                      Observed    Expected  Chi-square   DoF   p-value   
------------------------------------------------------------------------------
            Common           -        0.00        4.65     1  0.0310*     
------------------------------------------------------------------------------
  Lumped genotypes           -        0.00        1.17     1  0.2797      
------------------------------------------------------------------------------
   Common + lumped           -        0.00        5.82     1  0.0158*     
------------------------------------------------------------------------------
   All homozygotes          21       13.01        4.91     1  0.0268*     
------------------------------------------------------------------------------
 All heterozygotes          26       33.99        1.88     1  0.1706      
------------------------------------------------------------------------------
Common heterozygotes by allele
              0201          15       20.78        1.61        0.2050      
              0301          10       10.47        0.02        0.8850      
              0401           9       16.31        3.28        0.0703      
              0501          18       20.43        0.29        0.5915      

------------------------------------------------------------------------------
Common genotypes
         0201:0201           8        5.11        1.63        0.2014      
         0201:0401           3        6.93        2.23        0.1358      
         0201:0501           8        9.89        0.36        0.5472      
         0401:0501           5        6.70        0.43        0.5109      
             Total          24   28.632979
------------------------------------------------------------------------------
]]></programlisting>
  </example>

  <para> The pooling procedure is designed to avoid carrying out the
   chi-square goodness of fit test in cases where there are few
   expected counts, which could lead to spurious rejection of
   HWP. However, in certain cases it may not be possible to carry out
   this pooling approach.</para>

   
  <para>If the dataset contains no genotypes with expected counts equal or
   greater than 5, then there are no common genotypes and  the following
   message is reported: </para>

<programlisting>
   No common genotypes; chi-square cannot be calculated
</programlisting>

  <para>If the sum of expected counts in the lumped class does not add up to
   five, then the test for the lumped genotypes cannot be calculated and
   the following message is reported:</para>
  
<programlisting>
   The total number of expected genotypes is less than 5
</programlisting>

  <para>The lumping procedure may generate a dataset where there are fewer
   classes (genotypes) than allele frequencies to estimate.  This means
   that the analysis cannot be performed (degrees of freedom &lt; 1). In such
   a case the following message is reported, explaining why the analysis
   could not be performed:</para>

<programlisting>
   Too many parameters for chi-square test.
</programlisting>

  <para>This may by remedied by combining rare alleles and recalculating
   overall chi-square value and degrees of freedom.</para>
  
  <para>The heterozygotes by allele section summarizes the observed and
   expected number of counts of all heterozygotes carrying a specific
   allele with expected value &ge; 5. The genotypes by genotype section lists
   observed, expected, chi-square and p-values for all observed genotypes
   with expected values &ge; 5.</para>
  
</sect1>

 <sect1 id="instructions-hardyweinberg-exact">
  <title>Exact test for deviation from HWP</title>
  
  <para>For each locus the exact test for deviations from HWP is implemented
   using the method of Guo and Thompson (1992). The P-value provided
   describes how probable the observed set of genotypes is, with respect
   to a large sample of other genotypic configurations (conditioned on
   the same allele frequencies and 2n). P-values lower than 0.05 can be
   interpreted as evidence that the sample does not fit HWP.</para>
  
  <example>
   <title>Sample output for exact test</title>

<programlisting>
1.3. Guo and Thompson HardyWeinberg output [A]
______________________________________________

Dememorization steps: 2000
Number of samples: 1000
Sample size: 1000
Std. error: 0.0001534
p-value: 0.0006***
</programlisting>
  </example>

  <para>If there are many haplotypes, the exact test may be computationally
   impossible to implement. In this case the following message is reported:</para>

<programlisting>
2.3. Guo and Thompson HardyWeinberg output [C]
______________________________________________

Too large a matrix for Guo and Thompson
</programlisting>

 </sect1>
 
 <sect1 id="instructions-haplo">
  <title>Haplotype Frequency and LD Estimation</title>
  
  <para>Haplotypes frequencies are estimated using the iterative
   Expectation-Maximization (EM) algorithm (Dempster et al, 1977;
   Slatkin and Excoffier, 1995).</para>

  <para>Multiple starting conditions are used to minimize the possibility of
   local maxima being reached by the EM iterations. The haplotype
   frequencies reported are those that correspond to the highest
   logarithm of the sample likelihood found over the different starting
   conditions and are labeled as the maximum likelihood estimates
   (MLE).</para>

  <para>The output provides the of loci for which haplotype
   frequencies were estimated, the number of individual genotypes in
   the dataset (<literal>before-filtering</literal>), the number of
   genotypes that have data for all loci for which haplotype
   estimation will be performed (<literal>after-filtering</literal>),
   the number of unique phenotypes (unphased genotypes), the number of
   unique genotypes, the total number of possible haplotypes (many of
   these will have an estimated frequency of zero), and the
   log-likelihood of the observed genotypes under the assumption of
   linkage equilibrium.</para>

  <sect2>
  <title>Haplotype frequency estimation</title>

   <example>
    <title>Sample output of haplotype estimation parameters</title>

<programlisting><![CDATA[
Haplotype frequency est. for loci: A:B:DRB1
___________________________________________

Number of individuals: 47 (before-filtering)
Number of individuals: 45 (after-filtering)
Unique phenotypes: 45
Unique phenotypes: 113
Number of haplotypes: 188
Loglikelihood under linkage equilibrium ln(L_0): -472.700542
Loglikelihood obtained via the EM algorithm ln(L_1): -340.676530
Number of iterations before convergence: 67
]]></programlisting>
   </example>

   <para> The estimated haplotype frequencies are reported in order of
    decreasing frequency. Only haplotypes estimated at a frequency of
    0.00001 or larger are reported.  The first column give the allele
    names over the three loci, the second column provides the maximum
    likelihood estimate for their frequencies, (frequency), and the
    third column gives the corresponding approximate number of
    haplotypes (num. of copies).</para>

   <example>
    <title>Sample output of estimated haplotype frequencies</title>

<programlisting><![CDATA[
haplotype         frequency # copies  | haplotype         frequency # copies  
0101:1301:0402:   0.02222   2.0       | 0201:1401:0402:   0.03335   3.0       
0101:1301:1101:   0.01111   1.0       | 3204:1401:0802:   0.03333   3.0       
0101:1401:0901:   0.01111   1.0       | 0301:1401:0407:   0.03333   3.0       
0101:1520:0802:   0.01111   1.0       | 0301:1301:0402:   0.03333   3.0       
0101:1801:0407:   0.01111   1.0       | 0201:1401:1101:   0.03332   3.0       
0101:3902:0404:   0.01111   1.0       | 0301:1520:0802:   0.02222   2.0       
0101:3902:1602:   0.01111   1.0       | 0101:4005:0802:   0.02222   2.0       
0101:4005:0802:   0.02222   2.0       | 0301:3902:0402:   0.02222   2.0       
0101:8101:0802:   0.01111   1.0       | 0201:1301:1602:   0.02222   2.0       
0101:8101:1602:   0.01111   1.0       | 0218:1401:0404:   0.02222   2.0       
0201:1301:1602:   0.02222   2.0       | 0210:5101:1602:   0.02222   2.0       
0201:1401:0402:   0.03335   3.0       | 0218:1401:1602:   0.02222   2.0       
0201:1401:0404:   0.01111   1.0       | 0101:1301:0402:   0.02222   2.0       
0201:1401:0407:   0.02222   2.0       | 2501:4005:0802:   0.02222   2.0       
0201:1401:0802:   0.01111   1.0       | 2501:1301:0802:   0.02222   2.0       

...]]></programlisting>
   </example>
  </sect2>

  <sect2>
   <title>All pairwise LD</title>

   <para>For each pair of loci a series of linkage disequilibrium measures
    are provided:</para>

   <example>
    <title>Sample output of all pairwise LD</title>

<programlisting>
Pairwise LD estimates
_____________________

Locus pair        D'        Wn   ln(L_1)   ln(L_0)         S # permu p-value  
A:C          0.49229   0.39472   -289.09   -326.81     75.44    1000 0.8510   
A:B          0.50895   0.40145   -293.47   -330.83     74.73    1000 0.8730   
A:DRB1       0.44304   0.37671   -282.00   -309.16     54.32    1000 0.7540   
A:DQA1       0.29361   0.34239   -257.94   -269.88     23.88    1000 0.9020   
A:DQB1       0.39266   0.37495   -275.58   -297.61     44.07    1000 0.8140   
A:DPA1       0.31210   0.37987   -203.89   -206.99      6.21    1000 0.8840   
A:DPB1       0.42241   0.40404   -237.84   -262.05     48.42    1000 0.5930   
C:B          0.88739   0.85752   -210.36   -342.68    264.63    1000 0.0000***
C:DRB1       0.48046   0.47513   -280.34   -317.65     74.62    1000 0.2140   
C:DQA1       0.42257   0.49869   -250.36   -276.72     52.73    1000 0.0370*  
C:DQB1       0.45793   0.49879   -269.54   -305.27     71.46    1000 0.0580   
C:DPA1       0.37214   0.46870   -208.99   -215.36     12.74    1000 0.7450   
C:DPB1       0.46436   0.36984   -242.45   -268.45     52.01    1000 0.6290   
B:DRB1       0.50255   0.41712   -286.79   -320.50     67.42    1000 0.4140   
B:DQA1       0.41441   0.42844   -259.86   -279.56     39.40    1000 0.3880   
B:DQB1       0.49040   0.43654   -277.29   -308.12     61.65    1000 0.2870   
B:DPA1       0.29272   0.38831   -213.43   -218.01      9.14    1000 0.8780   
B:DPB1       0.46082   0.38001   -247.83   -272.77     49.86    1000 0.7320   
DRB1:DQA1    0.91847   0.91468   -164.06   -254.54    180.96    1000 0.0000***
DRB1:DQB1    1.00000   1.00000   -147.73   -283.09    270.72    1000 0.0000***

...
</programlisting>
   </example>

  </sect2>

</sect1>
 
 <bibliography id="instructions-references">
  <title>References</title>

  <bibliodiv>
   <title>General population genetics</title>
   
   <xi:include href="biblio.xml#xpointer(/bibliography/biblioentry[@id='Hartl:Clark'])"/>  

   <xi:include href="biblio.xml#xpointer(/bibliography/biblioentry[@id='Hedrick:1999'])"/>  

  </bibliodiv>
 </bibliography>

</article>

<!--
Local variables:
sgml-local-catalogs: ("catalog")
sgml-indent-step: 1
sgml-indent-data: 1
ispell-skip-html: t
End:
-->